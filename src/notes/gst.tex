\section{Gate Set Tomography}

Notes taken from \cite{nielsen_gate_2020}.

\noindent \ac{GST} differs from state and process tomography in that:
\begin{itemize}
    \item It is almost entirely calibration-free. It does not depend upon a prior description of the
    measurements used (as in state tomography) or the states that can be prepared (as in process
    tomography). \textit{These are called ``reference frame'' operations in the literature?}
    \item It estimates an entire set of logic operations, rather than a single one.
\end{itemize}

\ac{GST} being calibration-free is incredibly important. Both state and process tomography are
limited in that they rely on \textit{accurate} characterisation of their ``reference frame''
operations. Typically, they're either unknown or misidentified.

\subsection{Mathematical Background}

% The important part for me :(

A quantum system is described by a $d$-dimensional \textit{Hilbert space} $\mathcal{H} =
\mathbb{C}^d$, where $d$ is the largest number of outcomes of a repeatable measurement. For a qubit,
$d = 2$. GST uses the \textit{Hilbert-Schmidt space}. The Hilbert-Schmidt space is the complex
$d^2$-dimensional vector space of $d \times d$ matrices. We're interested in the $d^2$-dimensional
subspace of Hermitian matrices, denoted $\mathcal{B(H)}$. The basis we use for $\mathcal{B(H)}$ is
the set of normalised Pauli matrices $\{ \mathbb{I} / \sqrt{2}, \sigma_x / \sqrt{2}, \sigma_y /
\sqrt{2}, \sigma_z / \sqrt{2} \}$. This basis has the following properties:
\begin{itemize}
    \item Hermicity: $B_i = B_i^{\dagger}$
    \item Orthonormality: $\tr{B_i B_j} = \delta_{ij}$
    \item Traceless for $i > 0$: $B_0 = \mathbb{I} / \sqrt{d}$ and $\tr{B_i} = 0 \enspace \forall{i}
    > 0$.
\end{itemize}

Elements of $\mathcal{B(H)}$ are represented using an `extension' of Dirac's bra-ket notation called
\textit{super bra-ket notation}. Some element $B$ is represented as a column vector $\superket{B}$,
and an element of its dual space by a row vector $\superbra{A}$. Everything works similarly to
regular Dirac notation, the main difference is that we can represent everything as vectors in
$\mathcal{B(H)}$ rather than the usual matrices.

Measurement of a quantum system yields an outcome from a set of $k$ possibilities. Therefore, the
$i$th outcome can be represented by a dual vector $\superbra{E_i}$, so that $\Pr(i | \rho) =
\superbraket{E_i | \rho} = \tr{E_i \rho}$. Since they represent probabilities, we require that $E_i
\ge 0$ and $\sum_i E_i = \mathbb{I}$. The $E_i$ are called \textit{effects}, and the set $\{E_i \}$
is called a \ac{POVM}.  Note that since both states and effects are both Hermitian, we can in fact
represent them in the $d^2$-dimensional real subspace of $\mathcal{B(H)}$. Therefore, any reference
to $\mathcal{B(H)}$ is referring to the real subspace.

\subsection{Quantum Logic Gates}

An \textit{ideal} quantum logic gate is \textit{reversible} and corresponds to a unitary transform
of $\mathcal{H}$. Such a gate would transform $\rho$ as $\rho \to U \rho U^{\dagger}$ for some
unitary matrix $U$. This is a linear transformation from $\mathcal{B(H)}$ to itself; the linear
transformation $\rho \to U \rho U^{\dagger}$ is called a \textit{superoperator}. In reality, logic
gates are not perfectly reversible. These superoperators are known as quantum processes or quantum
channels. We can represent any superoperator $\Lambda$ as a $d^2 \times d^2$ matrix, which acts on
$\superket{\rho} \in \mathcal{B(H)}$ by left multiplication. This representation is called the
\textit{transfer matrix} of $\Lambda$, and is denoted by $S_{\Lambda}$. Thus,
\begin{equation}
    \Lambda : \superket{\rho} \mapsto S_{\Lambda} \superket{\rho}
\end{equation}
If $\Lambda$ is performed on some input state $\rho$, then the probability of outcome $E_i$ is
therefore
\begin{equation}
    p_i = \superbraket{E_i | S_{\Lambda} | \rho} = \tr{E_i S_{\Lambda} \rho}
\end{equation}

Not all superoperators describe physical operations. To be physically possible, they must be:
\begin{itemize}
    \item \textit{Trace-preserving}: $\tr{\Lambda(\rho)}$ must equal 1 for all $\rho$.
    \item \textit{Completely Positive}: when $\Lambda$ acts on part of a larger system, it must
    preserve positivity for the entire system. A superoperator is \textit{positive} iff.
    $\Lambda(\rho) \ge 0$ for all $\rho$. A superoperator is \textit{completely positive} iff.
    $\Lambda \otimes \mathbb{I}_{\mathcal{A}}$ is positive for any auxiliary state space
    $\mathcal{A}$.
\end{itemize}
This \ac{CPTP} constraint alone is sufficient -- any \ac{CPTP} superoperator can be physically
implemented. The TP condition corresponds to $\superbra{\mathbb{I}} S_{\Lambda} =
\superbra{\mathbb{I}}$. Since our basis is traceless for $i > 0$, then $\Lambda$ is TP iff. the
first row of $S_{\Lambda}$ is $[1, 0, \dots, 0]$. The CP condition is a lot more tricky to describe.
We first rewrite $S_{\Lambda}$ in the operator-sum representation:
\begin{equation}
    \Lambda : \rho \mapsto \sum_{ij} \chi_{ij}^{\Lambda} B_i \rho B_j^{\dagger}
\end{equation}
where $\{B_i\}$ is a basis, and $\chi_{ij}^{\Lambda}$ is a matrix of coefficients called the ``Choi
process matrix'' which represents $\Lambda$. Similarly to the chi matrix representation from
earlier, this completely describes $\Lambda$ (read
\href{https://quantumcomputing.stackexchange.com/a/11814}{this answer} for more about their
relationship). The mapping between $S_{\Lambda}$ and $\chi_{ij}^{\Lambda}$ is known as the
Choi-Jamio≈Çkowski isomorphism:
\begin{equation}
    \chi^{\Lambda} = d(S_{\Lambda} \otimes \mathbb{I}) \superket{\Pi_{\text{EPR}}}
\end{equation}
where $\superket{\Pi_{\text{EPR}}}$ is a maximally entangled state. Note that the equality above
really means element-wise equality in a consistent basis. This is all quite complex. Fortunately,
the process is simple once we have the Choi process matrix: $\Lambda$ is CP iff. $\chi$ is positive
semidefinite. 
\todoin{Research Choi representation vs. Chi representation}

\subsection{Gate Sets}

A quantum processor's capabilities can be specified with a \textit{gate set}. Consider a processor
that can perform:
\begin{itemize}
    \item $N_G$ distinct gates,
    \item $N_{\rho}$ distinct state preparations,
    \item $N_M$ distinct measurements, with $N_E^{(m)}$ distinct outcomes.
\end{itemize}
We can use these to construct a gate set
\begin{equation}
    \mathcal{G} = 
    \left\{
        \left\{
            \superket{\rho^{(i)}}
        \right\}^{N_{\rho}}_{i=1} ;
        \left\{
            G_i
        \right\}^{N_G}_{i=1} ;
        \left\{
            \superbra{E_i^{(m)}}
        \right\}^{N_m, N_E^{(m)}}_{m=1, i=1}
    \right\}
\end{equation}
where
\begin{equation}
    \begin{aligned}
        G_i : \mathcal{B(H)} \to \mathcal{B(H)}  \quad &\text{for} \quad i = 1, \dots, N_G \\
        \superket{\rho^{(i)}} \in \mathcal{B(H)} \quad &\text{for} \quad i = 1, \dots, N_{\rho} \\
        \superbra{E_i^{(m)}} \in \mathcal{B(H)}^*  \quad &\text{for} \quad m = 1, \dots, N_M, i = 1, \dots, N_E^{(m)} \\
    \end{aligned}
\end{equation}
In other words, we can describe the capabilities of a quantum processor by collecting together the
possible `input states', the quantum gates, and the possible measurement outcomes for each input
state.

\subsection{Circuits}

The term `quantum circuit' can refer to different things. There are two related but distinct types
of quantum circuit that we're interested in.
\begin{itemize}
    \item \textbf{Fixed-Input, Classical-Output (FI/CO)}: a quantum circuit where each experiment is
    described by a quantum circuit that begins by initialising and ends by measuring all of the
    qubits. A FI/CO circuit describes a probability distribution over classical bit strings.
    \item \textbf{Quantum-Input, Quantum-Output (QI/QO)}: a quantum circuit which is an arrangement
    of unitary logic gates, with no explicit initialisation or measurement. This may be inserted
    into a large quantum circuit as a `sub-routine'.
\end{itemize}

QI/QO circuits are defined as a sequence of layers $S = (\gamma_1, \gamma_2, \dots, \gamma_L)$. Each
layer corresponds to applying some superoperator $G_{\gamma_i}$. The entire QI/QO circuit $S$ also
corresponds to applying a superoperator. We denote the transfer matrix for $S$ by $\tau(S)$, where
\begin{equation}
    \tau(S) = \tau((\gamma_1, \gamma_2, \dots, \gamma_L)) = G_{\gamma_L} \dots G_{\gamma_2} G_{\gamma_1}
\end{equation}
which is formed by composing the elements from each layer. Exponentiation of a circuit describes
repetition, and since $S^2 = SS$, it follows that
\begin{equation}
    \tau(S^n) = \tau(S)^n
\end{equation}

For a set of FI/CO circuits, we can generate data sets by repeating each one $N$ times, and
recording the results. The results are summarized by observed frequencies, $f_k = n_k / N$, which
approaches the corresponding probabilities
\begin{equation}
    f_k \approx \superbraket{E_k^{(m)} | G_{\gamma_L} \dots G_{\gamma_2} G_{\gamma_1} | \rho^{(i)}}
\end{equation}
and can be used to estimate them. This is not the only way to do so, but it illustrates that we can
infer some of $\superket{\rho^{(i)}}$, $\superbra{E_k^{(m)}}$, and $G_j$ based on observed
frequencies. This is called tomography. \textit{Each type of tomography treats some of the
operations as known, and uses them as the reference frame to estimate the others}.

\subsection{Tomography}

\subsubsection{Quantum State Tomography}

In order to perform \textit{any} type of tomography, we must have a \textit{fiducial} and
\textit{informationally complete} set. ``Fiducial'' means that it is accepted as a fixed basis of
reference, and ``informationally complete'' means that it will uniquely identify any target
information. 

In the context of state tomography, we're aiming to describe some unknown quantum state $\rho$,
given some fiducial and informationally complete measurements. In other words, the measurements are
a frame of reference and must uniquely identify $\rho$. This implies that the set of measurements
$\{E_i^{(m)}\}_{m,i}$ must span the entire space of effects. To perform state tomography, many
copies of $\rho$ are made available, and divided into $M$ pools. The $m$th fiducial measurement is
applied to all the copies in the $m$th pool, and used to estimate the probabilities,
\begin{equation}
    p_i^{(m)} (\rho) = \tr{\rho E_i^{(m)}}
\end{equation}
which should uniquely identify $\rho$. In general, this is only true if we have infinite copies of
$\rho$. In practice, we have limited numbers of $\rho$, and therefore $\hat{p}_i = f_i$ where $f_i$
are the frequencies for each measurement. This often yields an estimate $\hat{\rho}$ which is not
positive. Nevertheless, it is still useful.

Let's assume that we have the exact probabilities for each measurement outcome for the state $\rho$.
We can in fact ignore the measurements themselves, what is important is the list of effects, so we
can write the set simply as $\{ E_j : j = 1, \dots, N_{f1}\}$ where $f1$ is the total number of
distinct measurement outcomes. Additionally, we can represent these as dual vectors $\superbra{E_j}$
in $\mathcal{B(H)}$ just like before. To recover $\rho$, we can write Born's rule as an inner
product, 
\begin{equation}
    \begin{aligned}
        p_j &= \tr{E_j \rho} \\
            &= \superbraket{E_j | \rho}
    \end{aligned}
\end{equation}
Then, we can stack all of the effects into a single $N_{f1} \times d^2$ matrix
\begin{equation}
    A = \begin{bmatrix}
        \superbra{E_1} \\
        \superbra{E_2} \\
        \vdots \\
        \superbra{E_{N_{f1}}}
    \end{bmatrix}
\end{equation}
which gives $\vec{p} = A \superket{\rho}$. If $A$ is square, then we can recover $\rho$ with:
\begin{equation}
    \superket{\rho} = A^{-1} \vec{p}
\end{equation}
If $N_{f1}$ is greater than $d^2$, making $A$ non-square, we must solve with a pseudo-inverse:
\begin{equation}
    \begin{aligned}
        (A^T A)^{-1} A^T \vec{p} &= (A^T A)^{-1} A^T A \superket{\rho} \\
                                 &= (A^T A)^{-1} (A^T A) \superket{\rho} \\
                                 &= I \superket{\rho} \\
                                 &= \superket{\rho}
    \end{aligned}
\end{equation}

\subsubsection{Quantum Process Tomography}

In the context of process tomography, we're aiming to describe some quantum process (e.g. a quantum
gate), given an informationally complete set of known fiducial states. Broadly,
we prepare many copies of them, pass them through the target process, and perform state tomography
on the output states.

Let $G$ be the superoperator representing the process we want to reconstruct. If state $\rho_i$ is
prepared, $G$ is applied, and measurement is performed with possible outcomes $\{E_j\}$, then the
probability of observing $E_j$ is
\begin{equation}
    \begin{aligned}
        P{j,i} &= \tr{E_j G[\rho_i]} \\
               &= \superbraket{E_j | G | \rho_i}
    \end{aligned}
\end{equation}
We can then define a $d^2 \times N_{f2}$ matrix $B$, similarly to $A$, which represents the fiducial
states $\superket{\rho_i}$:
\begin{equation}
    B = 
    \begin{bmatrix}
        \superket{\rho_1} & \superket{\rho_2} & \dots & \superket{\rho_{N_{f2}}}
    \end{bmatrix}
\end{equation}
which gives the $N_{f1} \times N_{f2}$ matrix $P = AGB$. Similarly to before, we can recover $G$ with
(pseudo)-inverses. If $P$ is square, we can recover $G$ with:
\begin{equation}
    G = A^{-1} P B^{-1}
\end{equation}
If $P$ is non-square, then again we use a pseudo-inverse:
\begin{equation}
    G = (A^T A)^{-1} A^T P B^T (B B^T)^{-1}
\end{equation}

\subsubsection{Calibration}

The requirements of fiducial states/measurements in state and process tomography show why GST being
calibration-free is important. In practice, we never have access to perfectly known
states/measurements, and they're also not noiseless. In order to identify the exact fiducial
measurements for state tomography, we would need perfectly known states, which would require state
tomography.  Similarly, process tomography relies on fiducial states and measurements which are
almost always produced by applying quantum logic gates. Identifying these would again require
process tomography. It's an endless loop of self-referentiality.
